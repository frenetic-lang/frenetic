OASISFormat: 0.4
OCamlVersion: >= 4.04.0
Name:        frenetic
Version:     4.0.0
Synopsis:    The Frenetic Compiler and Runtime System
Authors:     https://github.com/frenetic-lang/frenetic/contributors
License:     LGPL
Plugins:     META (0.4)
BuildTools:
  ocamlbuild,
  ocamldoc,
  menhir,
  cppo
BetaFeatures:
  findlib_extra_files
AlphaFeatures:
  ocamlbuild_more_args,
  source_patterns
XOCamlbuildExtraArgs:
  -use-menhir
  # see https://caml.inria.fr/pub/docs/manual-ocaml/native.html
  -cflags -w,@5+8@11@12-40,-short-paths
  # hack to make things compile
  # (jane street stuff must run after ppx_cstruct/cstruct.ppx)
  -package ppx_deriving,ppx_deriving.std,ppx_sexp_conv,ppx_fields_conv,ppx_type_conv,ppx_enumerate,ppx_compare

Library ppx
  Findlibparent: frenetic
  # need custom meta file
  XMETAEnable: false
  Path: ppx
  BuildDepends:
    ppx_tools, # (> 5.0) once available
    ppx_tools.metaquot,
    frenetic
  InternalModules:
    PPX_NetKAT_Parser
  Modules:
    PPX_NetKAT
  FindlibExtraFiles:
    ../ppx.native

Executable ppx
  Path: ppx
  BuildDepends:
    frenetic.ppx
  MainIs: ppx.ml
  CompiledObject: best
  Install: false

# just for testing and experimentation
Executable ppx_standalone
  # don't build by default
  Build: false
  Path: ppx
  BuildDepends:
    frenetic.ppx
  MainIs: ppx_standalone.ml
  CompiledObject: best
  Install: false

Library test_frenetic
  Findlibparent: frenetic
  Findlibname: test
  Path: lib_test/lib
  Build$: flag(tests)
  Install: false
  BuildDepends:
    frenetic,
    quickcheck
  Modules:
    Arbitrary_Base,
    Arbitrary_Frenetic_NetKAT,
    Arbitrary_Frenetic_OpenFlow,
    Arbitrary_Frenetic_OpenFlow0x01,
    Arbitrary_Frenetic_OpenFlow0x04,
    Arbitrary_Frenetic_OpenFlow_Header,
    Arbitrary_Frenetic_Packet,
    Flowterp

Executable testtool
  Path: lib_test
  MainIs: Test.ml
  Install: false
  Build$: flag(tests)
  BuildDepends:
    ppx_inline_test,
    frenetic.test,
    frenetic,
    frenetic.async

Test all_tests
  Run$: flag(tests)
  Command: $testtool inline-test-runner frenetic
  TestTools: testtool
