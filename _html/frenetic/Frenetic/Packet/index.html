<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Packet (frenetic.Frenetic.Packet)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">frenetic</a> &#x00BB; <a href="../index.html">Frenetic</a> &#x00BB; Packet</nav><h1>Module <code>Frenetic.Packet</code></h1><nav class="toc"><ul><li><a href="#packet-types">Packet types</a></li><li><a href="#accs">Accessors</a></li><li><a href="#mutators">Mutators</a></li><li><a href="#pretty-printing">Pretty Printing</a></li><li><a href="#marshal">Serialization</a></li></ul></nav></header><aside><p>Library for constructing, marshaling and parsing data packets. These packets are independent of OpenFlow message information - they are mostly used for the payloads of PacketIn and PacketOut messages.</p></aside><section><header><h6 id="packet-types"><a href="#packet-types" class="anchor"></a>Packet types</h6><p>It is possible to navigate the structure of a packet directly using the types defined here. However, using <a href="index.html#accs"><span>Accessors</span></a> may be more convenient.</p></header><dl><dt class="spec type" id="type-int8"><a href="#type-int8" class="anchor"></a><code><span class="keyword">type</span> int8</code><code> = int</code></dt><dd><p><code>int8</code> is the type of 8-bit integers.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-int8_of_sexp"><a href="#val-int8_of_sexp" class="anchor"></a><code><span class="keyword">val</span> int8_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-int8">int8</a></code></dt><dt class="spec value" id="val-sexp_of_int8"><a href="#val-sexp_of_int8" class="anchor"></a><code><span class="keyword">val</span> sexp_of_int8 : <a href="index.html#type-int8">int8</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_int8"><a href="#val-compare_int8" class="anchor"></a><code><span class="keyword">val</span> compare_int8 : <a href="index.html#type-int8">int8</a> <span>&#45;&gt;</span> <a href="index.html#type-int8">int8</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-int16"><a href="#type-int16" class="anchor"></a><code><span class="keyword">type</span> int16</code><code> = int</code></dt><dd><p><code>int16</code> is the type of 16-bit integers.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-int16_of_sexp"><a href="#val-int16_of_sexp" class="anchor"></a><code><span class="keyword">val</span> int16_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-int16">int16</a></code></dt><dt class="spec value" id="val-sexp_of_int16"><a href="#val-sexp_of_int16" class="anchor"></a><code><span class="keyword">val</span> sexp_of_int16 : <a href="index.html#type-int16">int16</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_int16"><a href="#val-compare_int16" class="anchor"></a><code><span class="keyword">val</span> compare_int16 : <a href="index.html#type-int16">int16</a> <span>&#45;&gt;</span> <a href="index.html#type-int16">int16</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-int48"><a href="#type-int48" class="anchor"></a><code><span class="keyword">type</span> int48</code><code> = int64</code></dt><dd><p><code>int48</code> is the type of 48-bit integers.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-int48_of_sexp"><a href="#val-int48_of_sexp" class="anchor"></a><code><span class="keyword">val</span> int48_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-int48">int48</a></code></dt><dt class="spec value" id="val-sexp_of_int48"><a href="#val-sexp_of_int48" class="anchor"></a><code><span class="keyword">val</span> sexp_of_int48 : <a href="index.html#type-int48">int48</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_int48"><a href="#val-compare_int48" class="anchor"></a><code><span class="keyword">val</span> compare_int48 : <a href="index.html#type-int48">int48</a> <span>&#45;&gt;</span> <a href="index.html#type-int48">int48</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-dlAddr"><a href="#type-dlAddr" class="anchor"></a><code><span class="keyword">type</span> dlAddr</code><code> = <a href="index.html#type-int48">int48</a></code></dt><dd><p><code>dlAddr</code> is the type of Ethernet addresses.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-dlAddr_of_sexp"><a href="#val-dlAddr_of_sexp" class="anchor"></a><code><span class="keyword">val</span> dlAddr_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-dlAddr">dlAddr</a></code></dt><dt class="spec value" id="val-sexp_of_dlAddr"><a href="#val-sexp_of_dlAddr" class="anchor"></a><code><span class="keyword">val</span> sexp_of_dlAddr : <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_dlAddr"><a href="#val-compare_dlAddr" class="anchor"></a><code><span class="keyword">val</span> compare_dlAddr : <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-dlTyp"><a href="#type-dlTyp" class="anchor"></a><code><span class="keyword">type</span> dlTyp</code><code> = <a href="index.html#type-int16">int16</a></code></dt><dd><p><code>dlTyp</code> is the type of Ethernet frame types.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-dlTyp_of_sexp"><a href="#val-dlTyp_of_sexp" class="anchor"></a><code><span class="keyword">val</span> dlTyp_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-dlTyp">dlTyp</a></code></dt><dt class="spec value" id="val-sexp_of_dlTyp"><a href="#val-sexp_of_dlTyp" class="anchor"></a><code><span class="keyword">val</span> sexp_of_dlTyp : <a href="index.html#type-dlTyp">dlTyp</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_dlTyp"><a href="#val-compare_dlTyp" class="anchor"></a><code><span class="keyword">val</span> compare_dlTyp : <a href="index.html#type-dlTyp">dlTyp</a> <span>&#45;&gt;</span> <a href="index.html#type-dlTyp">dlTyp</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-dlVlan"><a href="#type-dlVlan" class="anchor"></a><code><span class="keyword">type</span> dlVlan</code><code> = <span><a href="index.html#type-int16">int16</a> option</span></code></dt><dd><p><code>dlVlan</code> is the type of VLAN identifiers. A value of <code>None</code> indicates that no 802.1Q (VLAN) header is set, which is distinct from setting the VLAN to 0.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-dlVlan_of_sexp"><a href="#val-dlVlan_of_sexp" class="anchor"></a><code><span class="keyword">val</span> dlVlan_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-dlVlan">dlVlan</a></code></dt><dt class="spec value" id="val-sexp_of_dlVlan"><a href="#val-sexp_of_dlVlan" class="anchor"></a><code><span class="keyword">val</span> sexp_of_dlVlan : <a href="index.html#type-dlVlan">dlVlan</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_dlVlan"><a href="#val-compare_dlVlan" class="anchor"></a><code><span class="keyword">val</span> compare_dlVlan : <a href="index.html#type-dlVlan">dlVlan</a> <span>&#45;&gt;</span> <a href="index.html#type-dlVlan">dlVlan</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-dlVlanPcp"><a href="#type-dlVlanPcp" class="anchor"></a><code><span class="keyword">type</span> dlVlanPcp</code><code> = <a href="index.html#type-int8">int8</a></code></dt><dd><p><code>dlVlanPcp</code> is the type of 802.1Q (VLAN) priorities.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-dlVlanPcp_of_sexp"><a href="#val-dlVlanPcp_of_sexp" class="anchor"></a><code><span class="keyword">val</span> dlVlanPcp_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-dlVlanPcp">dlVlanPcp</a></code></dt><dt class="spec value" id="val-sexp_of_dlVlanPcp"><a href="#val-sexp_of_dlVlanPcp" class="anchor"></a><code><span class="keyword">val</span> sexp_of_dlVlanPcp : <a href="index.html#type-dlVlanPcp">dlVlanPcp</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_dlVlanPcp"><a href="#val-compare_dlVlanPcp" class="anchor"></a><code><span class="keyword">val</span> compare_dlVlanPcp : <a href="index.html#type-dlVlanPcp">dlVlanPcp</a> <span>&#45;&gt;</span> <a href="index.html#type-dlVlanPcp">dlVlanPcp</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-dlVlanDei"><a href="#type-dlVlanDei" class="anchor"></a><code><span class="keyword">type</span> dlVlanDei</code><code> = bool</code></dt><dd><p><code>dlVlanDei</code> is the type of 802.1Q (VLAN) drop eligible indicator.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-dlVlanDei_of_sexp"><a href="#val-dlVlanDei_of_sexp" class="anchor"></a><code><span class="keyword">val</span> dlVlanDei_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-dlVlanDei">dlVlanDei</a></code></dt><dt class="spec value" id="val-sexp_of_dlVlanDei"><a href="#val-sexp_of_dlVlanDei" class="anchor"></a><code><span class="keyword">val</span> sexp_of_dlVlanDei : <a href="index.html#type-dlVlanDei">dlVlanDei</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_dlVlanDei"><a href="#val-compare_dlVlanDei" class="anchor"></a><code><span class="keyword">val</span> compare_dlVlanDei : <a href="index.html#type-dlVlanDei">dlVlanDei</a> <span>&#45;&gt;</span> <a href="index.html#type-dlVlanDei">dlVlanDei</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-nwAddr"><a href="#type-nwAddr" class="anchor"></a><code><span class="keyword">type</span> nwAddr</code><code> = int32</code></dt><dd><p><code>nwAddr</code> is the type of IPv4 addresses.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-nwAddr_of_sexp"><a href="#val-nwAddr_of_sexp" class="anchor"></a><code><span class="keyword">val</span> nwAddr_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a></code></dt><dt class="spec value" id="val-sexp_of_nwAddr"><a href="#val-sexp_of_nwAddr" class="anchor"></a><code><span class="keyword">val</span> sexp_of_nwAddr : <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_nwAddr"><a href="#val-compare_nwAddr" class="anchor"></a><code><span class="keyword">val</span> compare_nwAddr : <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-nwProto"><a href="#type-nwProto" class="anchor"></a><code><span class="keyword">type</span> nwProto</code><code> = <a href="index.html#type-int8">int8</a></code></dt><dd><p><code>nwProto</code> is the type of IPv4 protocol numbers.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-nwProto_of_sexp"><a href="#val-nwProto_of_sexp" class="anchor"></a><code><span class="keyword">val</span> nwProto_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-nwProto">nwProto</a></code></dt><dt class="spec value" id="val-sexp_of_nwProto"><a href="#val-sexp_of_nwProto" class="anchor"></a><code><span class="keyword">val</span> sexp_of_nwProto : <a href="index.html#type-nwProto">nwProto</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_nwProto"><a href="#val-compare_nwProto" class="anchor"></a><code><span class="keyword">val</span> compare_nwProto : <a href="index.html#type-nwProto">nwProto</a> <span>&#45;&gt;</span> <a href="index.html#type-nwProto">nwProto</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-nwTos"><a href="#type-nwTos" class="anchor"></a><code><span class="keyword">type</span> nwTos</code><code> = <a href="index.html#type-int8">int8</a></code></dt><dd><p><code>nwTos</code> is the type of IPv4 types of service.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-nwTos_of_sexp"><a href="#val-nwTos_of_sexp" class="anchor"></a><code><span class="keyword">val</span> nwTos_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-nwTos">nwTos</a></code></dt><dt class="spec value" id="val-sexp_of_nwTos"><a href="#val-sexp_of_nwTos" class="anchor"></a><code><span class="keyword">val</span> sexp_of_nwTos : <a href="index.html#type-nwTos">nwTos</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_nwTos"><a href="#val-compare_nwTos" class="anchor"></a><code><span class="keyword">val</span> compare_nwTos : <a href="index.html#type-nwTos">nwTos</a> <span>&#45;&gt;</span> <a href="index.html#type-nwTos">nwTos</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-ipv6Addr"><a href="#type-ipv6Addr" class="anchor"></a><code><span class="keyword">type</span> ipv6Addr</code><code> = int64 * int64</code></dt><dd><p><code>ipv6Addr</code> is the type of IPv6 addresses.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-ipv6Addr_of_sexp"><a href="#val-ipv6Addr_of_sexp" class="anchor"></a><code><span class="keyword">val</span> ipv6Addr_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-ipv6Addr">ipv6Addr</a></code></dt><dt class="spec value" id="val-sexp_of_ipv6Addr"><a href="#val-sexp_of_ipv6Addr" class="anchor"></a><code><span class="keyword">val</span> sexp_of_ipv6Addr : <a href="index.html#type-ipv6Addr">ipv6Addr</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_ipv6Addr"><a href="#val-compare_ipv6Addr" class="anchor"></a><code><span class="keyword">val</span> compare_ipv6Addr : <a href="index.html#type-ipv6Addr">ipv6Addr</a> <span>&#45;&gt;</span> <a href="index.html#type-ipv6Addr">ipv6Addr</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-tpPort"><a href="#type-tpPort" class="anchor"></a><code><span class="keyword">type</span> tpPort</code><code> = <a href="index.html#type-int16">int16</a></code></dt><dd><p><code>tpPort</code> is the type of transport protocol ports.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-tpPort_of_sexp"><a href="#val-tpPort_of_sexp" class="anchor"></a><code><span class="keyword">val</span> tpPort_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-tpPort">tpPort</a></code></dt><dt class="spec value" id="val-sexp_of_tpPort"><a href="#val-sexp_of_tpPort" class="anchor"></a><code><span class="keyword">val</span> sexp_of_tpPort : <a href="index.html#type-tpPort">tpPort</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt><dt class="spec value" id="val-compare_tpPort"><a href="#val-compare_tpPort" class="anchor"></a><code><span class="keyword">val</span> compare_tpPort : <a href="index.html#type-tpPort">tpPort</a> <span>&#45;&gt;</span> <a href="index.html#type-tpPort">tpPort</a> <span>&#45;&gt;</span> int</code></dt></dl></div></div></div><dl><dt class="spec module" id="module-Tcp"><a href="#module-Tcp" class="anchor"></a><code><span class="keyword">module</span> <a href="Tcp/index.html">Tcp</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>TCP frame of a packet.</p></dd></dl><dl><dt class="spec module" id="module-Udp"><a href="#module-Udp" class="anchor"></a><code><span class="keyword">module</span> <a href="Udp/index.html">Udp</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>UDP frame of a packet.</p></dd></dl><dl><dt class="spec module" id="module-Icmp"><a href="#module-Icmp" class="anchor"></a><code><span class="keyword">module</span> <a href="Icmp/index.html">Icmp</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>ICMP frame of a packet.</p></dd></dl><dl><dt class="spec module" id="module-Dns"><a href="#module-Dns" class="anchor"></a><code><span class="keyword">module</span> <a href="Dns/index.html">Dns</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Basic DNS packet type.</p></dd></dl><dl><dt class="spec module" id="module-Igmp1and2"><a href="#module-Igmp1and2" class="anchor"></a><code><span class="keyword">module</span> <a href="Igmp1and2/index.html">Igmp1and2</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>IGMP v1 and v2 message type.</p></dd></dl><dl><dt class="spec module" id="module-Igmp3"><a href="#module-Igmp3" class="anchor"></a><code><span class="keyword">module</span> <a href="Igmp3/index.html">Igmp3</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>IGMP v3 message type.</p></dd></dl><dl><dt class="spec module" id="module-Igmp"><a href="#module-Igmp" class="anchor"></a><code><span class="keyword">module</span> <a href="Igmp/index.html">Igmp</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>IGMP frame of a packet.</p></dd></dl><dl><dt class="spec module" id="module-Ip"><a href="#module-Ip" class="anchor"></a><code><span class="keyword">module</span> <a href="Ip/index.html">Ip</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>IPv4 frame of a packet.</p></dd></dl><dl><dt class="spec module" id="module-Arp"><a href="#module-Arp" class="anchor"></a><code><span class="keyword">module</span> <a href="Arp/index.html">Arp</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Address resolution protocol (ARP) packet payload.</p></dd></dl><dl><dt class="spec type" id="type-nw"><a href="#type-nw" class="anchor"></a><code><span class="keyword">type</span> nw</code><code> = </code><table class="variant"><tr id="type-nw.Ip" class="anchored"><td class="def constructor"><a href="#type-nw.Ip" class="anchor"></a><code>| </code><code><span class="constructor">Ip</span> <span class="keyword">of</span> <a href="Ip/index.html#type-t">Ip.t</a></code></td><td class="doc"><p>Internet Protocol version 4 (IPv4).</p></td></tr><tr id="type-nw.Arp" class="anchored"><td class="def constructor"><a href="#type-nw.Arp" class="anchor"></a><code>| </code><code><span class="constructor">Arp</span> <span class="keyword">of</span> <a href="Arp/index.html#type-t">Arp.t</a></code></td><td class="doc"><p>Address Resolution Protocol (ARP).</p></td></tr><tr id="type-nw.Unparsable" class="anchored"><td class="def constructor"><a href="#type-nw.Unparsable" class="anchor"></a><code>| </code><code><span class="constructor">Unparsable</span> <span class="keyword">of</span> <a href="index.html#type-dlTyp">dlTyp</a> * Cstruct.t</code></td><td class="doc"><p>The EtherType code accompanied by the uninterpreted ethernet payload.</p></td></tr></table></dt><dd><p>The type <code>nw</code> represents a packet at the network protocol level.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-nw_of_sexp"><a href="#val-nw_of_sexp" class="anchor"></a><code><span class="keyword">val</span> nw_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-nw">nw</a></code></dt><dt class="spec value" id="val-sexp_of_nw"><a href="#val-sexp_of_nw" class="anchor"></a><code><span class="keyword">val</span> sexp_of_nw : <a href="index.html#type-nw">nw</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt></dl></div></div></div><dl><dt class="spec type" id="type-packet"><a href="#type-packet" class="anchor"></a><code><span class="keyword">type</span> packet</code><code> = </code><code>{</code><table class="record"><tr id="type-packet.dlSrc" class="anchored"><td class="def field"><a href="#type-packet.dlSrc" class="anchor"></a><code>dlSrc : <a href="index.html#type-dlAddr">dlAddr</a>;</code></td><td class="doc"><p>Ethernet source address.</p></td></tr><tr id="type-packet.dlDst" class="anchored"><td class="def field"><a href="#type-packet.dlDst" class="anchor"></a><code>dlDst : <a href="index.html#type-dlAddr">dlAddr</a>;</code></td><td class="doc"><p>Ethernet destination address.</p></td></tr><tr id="type-packet.dlVlan" class="anchored"><td class="def field"><a href="#type-packet.dlVlan" class="anchor"></a><code>dlVlan : <a href="index.html#type-dlVlan">dlVlan</a>;</code></td><td class="doc"><p>802.1Q VLAN identifier, if any.</p></td></tr><tr id="type-packet.dlVlanDei" class="anchored"><td class="def field"><a href="#type-packet.dlVlanDei" class="anchor"></a><code>dlVlanDei : <a href="index.html#type-dlVlanDei">dlVlanDei</a>;</code></td><td class="doc"><p>802.1Q VLAN Drop Eligible Indciator. Ignored if <code>dlVlan</code> is <code>None</code></p></td></tr><tr id="type-packet.dlVlanPcp" class="anchored"><td class="def field"><a href="#type-packet.dlVlanPcp" class="anchor"></a><code>dlVlanPcp : <a href="index.html#type-dlVlanPcp">dlVlanPcp</a>;</code></td><td class="doc"><p>802.1Q VLAN priority. Ignored if <code>dlVlan</code> is <code>None</code>.</p></td></tr><tr id="type-packet.nw" class="anchored"><td class="def field"><a href="#type-packet.nw" class="anchor"></a><code>nw : <a href="index.html#type-nw">nw</a>;</code></td><td class="doc"><p>Network payload.</p></td></tr></table><code>}</code></dt><dd><p>The type <code>packet</code> represents a packet at the ethernet protocol level.</p></dd></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-packet_of_sexp"><a href="#val-packet_of_sexp" class="anchor"></a><code><span class="keyword">val</span> packet_of_sexp : Ppx_sexp_conv_lib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dt class="spec value" id="val-sexp_of_packet"><a href="#val-sexp_of_packet" class="anchor"></a><code><span class="keyword">val</span> sexp_of_packet : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> Ppx_sexp_conv_lib.Sexp.t</code></dt></dl></div></div></div></section><section><header><h6 id="accs"><a href="#accs" class="anchor"></a>Accessors</h6></header><dl><dt class="spec value" id="val-dlTyp"><a href="#val-dlTyp" class="anchor"></a><code><span class="keyword">val</span> dlTyp : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-dlTyp">dlTyp</a></code></dt><dd><p><code>dlTyp pkt</code> returns the ethernet frame type of <code>pkt</code></p></dd></dl><dl><dt class="spec value" id="val-nwSrc"><a href="#val-nwSrc" class="anchor"></a><code><span class="keyword">val</span> nwSrc : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a></code></dt><dd><p><code>nwSrc pkt</code> returns the source IP address of <code>pkt</code>. </p><dl><dt>raises </dt><dd><p>Invalid_argument if the packet is not carrying an IP payload.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-nwDst"><a href="#val-nwDst" class="anchor"></a><code><span class="keyword">val</span> nwDst : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a></code></dt><dd><p><code>nwDst pkt</code> returns the destination IP address of <code>pkt</code>. </p><dl><dt>raises </dt><dd><p>Invalid_argument if the packet is not carrying an IP payload.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-nwTos"><a href="#val-nwTos" class="anchor"></a><code><span class="keyword">val</span> nwTos : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwTos">nwTos</a></code></dt><dd><p><code>nwTos pkt</code> returns the IPv4 type of service of <code>pkt</code>. </p><dl><dt>raises </dt><dd><p>Invalid_argument if the packet is not carrying an IP payload.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-nwProto"><a href="#val-nwProto" class="anchor"></a><code><span class="keyword">val</span> nwProto : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwProto">nwProto</a></code></dt><dd><p><code>nwProto pkt</code> returns the IP protocol number of <code>pkt</code>. </p><dl><dt>raises </dt><dd><p>Invalid_argument if the packet is not carrying an IP payload.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-tpSrc"><a href="#val-tpSrc" class="anchor"></a><code><span class="keyword">val</span> tpSrc : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-tpPort">tpPort</a></code></dt><dd><p><code>tpSrc pkt</code> returns the transport protocol source port of <code>pkt</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the packet is not carrying a TCP or UDP payload.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-tpDst"><a href="#val-tpDst" class="anchor"></a><code><span class="keyword">val</span> tpDst : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-tpPort">tpPort</a></code></dt><dd><p><code>tpDst pkt</code> returns the transport protocol destination port of <code>pkt</code>. </p><dl><dt>raises Invalid_argument</dt><dd><p>if the packet is not carrying a TCP or UDP payload.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-arpOperation"><a href="#val-arpOperation" class="anchor"></a><code><span class="keyword">val</span> arpOperation : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>arpOperation pkt</code> returns the ARP operation code of <code>pkt</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the packet is not carrying a ARP payload.</p></dd></dl></dd></dl></section><section><header><h6 id="mutators"><a href="#mutators" class="anchor"></a>Mutators</h6></header><dl><dt class="spec value" id="val-setDlSrc"><a href="#val-setDlSrc" class="anchor"></a><code><span class="keyword">val</span> setDlSrc : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setDlSrc pkt addr</code> sets the ethernet source address of <code>pkt</code> to <code>addr</code>.</p></dd></dl><dl><dt class="spec value" id="val-setDlDst"><a href="#val-setDlDst" class="anchor"></a><code><span class="keyword">val</span> setDlDst : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setDlDst pkt addr</code> sets the ethernet destination address of <code>pkt</code> to <code>addr</code>.</p></dd></dl><dl><dt class="spec value" id="val-setDlVlan"><a href="#val-setDlVlan" class="anchor"></a><code><span class="keyword">val</span> setDlVlan : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-dlVlan">dlVlan</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setDlVlan pkt vlan</code> sets the VLAN identifier of <code>pkt</code> to <code>vlan</code>.</p></dd></dl><dl><dt class="spec value" id="val-setDlVlanPcp"><a href="#val-setDlVlanPcp" class="anchor"></a><code><span class="keyword">val</span> setDlVlanPcp : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-dlVlanPcp">dlVlanPcp</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setDlVlanPcp pkt pri</code> sets the VLAN priority of <code>pkt</code> to <code>pri</code>.</p></dd></dl><dl><dt class="spec value" id="val-setNwSrc"><a href="#val-setNwSrc" class="anchor"></a><code><span class="keyword">val</span> setNwSrc : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setNwSrc pkt</code> sets the source IP address of <code>pkt</code> if the packet carries an IP payload. Otherwise, it returns the packet unchanged.</p></dd></dl><dl><dt class="spec value" id="val-setNwDst"><a href="#val-setNwDst" class="anchor"></a><code><span class="keyword">val</span> setNwDst : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setNwDst pkt</code> sets the destination IP address of <code>pkt</code> if the packet carries an IP payload. Otherwise, it returns the packet unchanged.</p></dd></dl><dl><dt class="spec value" id="val-setNwTos"><a href="#val-setNwTos" class="anchor"></a><code><span class="keyword">val</span> setNwTos : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-nwTos">nwTos</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setNwTos pkt</code> sets the IPv4 type of service of <code>pkt</code> if the packet carries an IP payload. Otherwise, it returns the packet unchanged.</p></dd></dl><dl><dt class="spec value" id="val-setTpSrc"><a href="#val-setTpSrc" class="anchor"></a><code><span class="keyword">val</span> setTpSrc : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-tpPort">tpPort</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setTpSrc pkt</code> sets the transport protocol source port of <code>pkt</code> if the packet carries a TCP or UDP payload. Otherwise, it returns the packet unchanged.</p></dd></dl><dl><dt class="spec value" id="val-setTpDst"><a href="#val-setTpDst" class="anchor"></a><code><span class="keyword">val</span> setTpDst : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> <a href="index.html#type-tpPort">tpPort</a> <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>setTpDst pkt</code> sets the transport protocol destination port of <code>pkt</code> if the packet carries a TCP or UDP payload. Otherwise, it returns the packet unchanged.</p></dd></dl></section><section><header><h6 id="pretty-printing"><a href="#pretty-printing" class="anchor"></a>Pretty Printing</h6></header><dl><dt class="spec value" id="val-string_of_mac"><a href="#val-string_of_mac" class="anchor"></a><code><span class="keyword">val</span> string_of_mac : <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_mac mac</code> pretty-prints an ethernet address.</p></dd></dl><dl><dt class="spec value" id="val-mac_of_string"><a href="#val-mac_of_string" class="anchor"></a><code><span class="keyword">val</span> mac_of_string : string <span>&#45;&gt;</span> <a href="index.html#type-dlAddr">dlAddr</a></code></dt><dd><p><code>mac_of_string string</code> converts an colon-separated ethernet address to a <code>dlAddr</code> *</p></dd></dl><dl><dt class="spec value" id="val-string_of_dlAddr"><a href="#val-string_of_dlAddr" class="anchor"></a><code><span class="keyword">val</span> string_of_dlAddr : <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_dlAddr addr</code> is identical to <code>string_of_mac</code>.</p></dd></dl><dl><dt class="spec value" id="val-string_of_dlTyp"><a href="#val-string_of_dlTyp" class="anchor"></a><code><span class="keyword">val</span> string_of_dlTyp : <a href="index.html#type-dlTyp">dlTyp</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_dlTyp typ</code> pretty-prints an ethernet frame type.</p></dd></dl><dl><dt class="spec value" id="val-string_of_dlVlan"><a href="#val-string_of_dlVlan" class="anchor"></a><code><span class="keyword">val</span> string_of_dlVlan : <a href="index.html#type-dlVlan">dlVlan</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_dlVlan vlan</code> pretty-prints an 802.1Q VLAN identifier.</p></dd></dl><dl><dt class="spec value" id="val-string_of_dlVlanPcp"><a href="#val-string_of_dlVlanPcp" class="anchor"></a><code><span class="keyword">val</span> string_of_dlVlanPcp : <a href="index.html#type-dlVlanPcp">dlVlanPcp</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_dlVlanPcp p</code> pretty-prints an 802.1Q VLAN priority.</p></dd></dl><dl><dt class="spec value" id="val-string_of_ip"><a href="#val-string_of_ip" class="anchor"></a><code><span class="keyword">val</span> string_of_ip : <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_ip ip</code> pretty-prints an IPv4 address.</p></dd></dl><dl><dt class="spec value" id="val-ip_of_string"><a href="#val-ip_of_string" class="anchor"></a><code><span class="keyword">val</span> ip_of_string : string <span>&#45;&gt;</span> <a href="index.html#type-nwAddr">nwAddr</a></code></dt><dd><p><code>ip_of_string string</code> converts an dot-separated IPv4 address to a <code>nwAddr</code> *</p></dd></dl><dl><dt class="spec value" id="val-string_of_nwAddr"><a href="#val-string_of_nwAddr" class="anchor"></a><code><span class="keyword">val</span> string_of_nwAddr : <a href="index.html#type-nwAddr">nwAddr</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_nwAddr addr</code> is identical to <code>string_of_ip</code>.</p></dd></dl><dl><dt class="spec value" id="val-string_of_nwProto"><a href="#val-string_of_nwProto" class="anchor"></a><code><span class="keyword">val</span> string_of_nwProto : <a href="index.html#type-nwProto">nwProto</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_nwProto p</code> pretty-prints an IPv4 protocol.</p></dd></dl><dl><dt class="spec value" id="val-string_of_nwTos"><a href="#val-string_of_nwTos" class="anchor"></a><code><span class="keyword">val</span> string_of_nwTos : <a href="index.html#type-nwTos">nwTos</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_nwTos t</code> pretty-prints an IPv4 type of service.</p></dd></dl><dl><dt class="spec value" id="val-string_of_ipv6"><a href="#val-string_of_ipv6" class="anchor"></a><code><span class="keyword">val</span> string_of_ipv6 : <a href="index.html#type-ipv6Addr">ipv6Addr</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_ipv6 t</code> pretty-prints an IPv6 address. *</p></dd></dl><dl><dt class="spec value" id="val-ipv6_of_string"><a href="#val-ipv6_of_string" class="anchor"></a><code><span class="keyword">val</span> ipv6_of_string : string <span>&#45;&gt;</span> <a href="index.html#type-ipv6Addr">ipv6Addr</a></code></dt><dd><p><code>string_of_ipv6 t</code> Converts a colon-separated IPv6 address to ipv6Addr. *</p></dd></dl><dl><dt class="spec value" id="val-string_of_tpPort"><a href="#val-string_of_tpPort" class="anchor"></a><code><span class="keyword">val</span> string_of_tpPort : <a href="index.html#type-tpPort">tpPort</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string_of_tpPort p</code> pretty-prints a transport protocol port number.</p></dd></dl><dl><dt class="spec value" id="val-bytes_of_mac"><a href="#val-bytes_of_mac" class="anchor"></a><code><span class="keyword">val</span> bytes_of_mac : <a href="index.html#type-dlAddr">dlAddr</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>bytes_of_mac mac</code> returns a bit-string representation of <code>mac</code>.</p></dd></dl><dl><dt class="spec value" id="val-mac_of_bytes"><a href="#val-mac_of_bytes" class="anchor"></a><code><span class="keyword">val</span> mac_of_bytes : string <span>&#45;&gt;</span> <a href="index.html#type-int48">int48</a></code></dt><dd><p><code>mac_of_bytes str</code> constructs a <code>dlAddr</code> from a bit-string representation. </p><dl><dt>raises Invalid_argument</dt><dd><p>if the length of the string is not six characters.</p></dd></dl></dd></dl></section><section><header><h6 id="marshal"><a href="#marshal" class="anchor"></a>Serialization</h6></header><dl><dt class="spec value" id="val-parse"><a href="#val-parse" class="anchor"></a><code><span class="keyword">val</span> parse : Cstruct.t <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a></code></dt><dd><p><code>parse bits</code> parses a bit sequence into a packet.</p></dd></dl><dl><dt class="spec value" id="val-len"><a href="#val-len" class="anchor"></a><code><span class="keyword">val</span> len : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>len pkt</code> length of packet in bytes.</p></dd></dl><dl><dt class="spec value" id="val-marshal"><a href="#val-marshal" class="anchor"></a><code><span class="keyword">val</span> marshal : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>marshal pkt</code> marshals <code>pkt</code> into a bit sequence.</p></dd></dl><dl><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val</span> to_string : <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>to_string pkt</code> prints <code>pkt</code> as a string.</p></dd></dl><dl><dt class="spec value" id="val-format_packet"><a href="#val-format_packet" class="anchor"></a><code><span class="keyword">val</span> format_packet : Stdlib.Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-packet">packet</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>format_packet fmt pkt</code> uses formatter <code>fmt</code> to format <code>pkt</code>.</p></dd></dl></section></div></body></html>